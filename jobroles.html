<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Role Information | Job Portal</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* All the CSS from the provided code goes here */
        :root {
            /* All the CSS variables from the provided code */
            --primary: #000000;
            --primary-dark: #423d7b;
            --primary-light: #d7161600;
            --secondary: #10B981;
            --accent: #F59E0B;
            --text-primary: #1F2937;
            --text-secondary: #4B5563;
            --bg-primary: #ebeaea5a;  
            --bg-secondary: #fdfafa; 
            --bg-tertiary: #ffffff;
            --border-color: #0a0a0b;
            --card-shadow: 0 4px 6px rgba(247, 244, 244, 0.952), 0 1px 3px rgba(230, 221, 221, 0.947);
            --success: #10B981;
            --warning: #F59E0B;
            --gradient: linear-gradient(135deg, #0d0d0d 0%, #141219 100%);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* All the other CSS from the provided code */
        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; 
        }

        body { 
            background: var(--bg-primary); 
            color: var(--text-primary); 
            line-height: 1.6;
            font-size: 14px;
            transition: var(--transition);
        }

        /* Header */
        header {
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            padding: 16px 32px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 4px 6px -1px rgba(236, 201, 75, 0.1)
        }

        .logo {
            font-size: 24px;
            font-weight: 700;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 12px;
            font-family: 'Poppins', sans-serif;
        }

        .logo span {
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .logo i {
            font-size: 28px;
            color: var(--primary);
        }

        nav {
            display: flex;
            gap: 32px;
            align-items: center;
        }

        nav a {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 500;
            font-size: 15px;
            transition: var(--transition);
            position: relative;
            padding: 8px 0;
        }

        nav a:hover {
            color: var(--text-primary);
        }

        nav a::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--gradient);
            transition: var(--transition);
        }

        nav a:hover::after {
            width: 100%;
        }

        nav a.active {
            color: var(--text-primary);
        }

        nav a.active::after {
            width: 100%;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            padding: 8px 16px;
            border-radius: 12px;
            transition: var(--transition);
            background: var(--bg-tertiary);
        }

        .user-info:hover {
            background: rgb(11, 10, 10);
            color: white;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: white;
            font-size: 16px;
        }

        .theme-toggle {
            background: var(--bg-tertiary);
            border: none;
            color: var(--text-primary);
            cursor: pointer;
            font-size: 18px;
            width: 44px;
            height: 44px;
            border-radius: 12px;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .theme-toggle:hover {
            background: var(--border-color);
            transform: rotate(15deg);
        }

        /* Container */
        .container {
            display: flex;
            min-height: calc(100vh - 80px);
            padding: 32px;
            gap: 32px;
        }

        /* Role Details Section */
        .role-details-section {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 32px;
        }

        .role-card {
            background: var(--bg-secondary);
            border-radius: 16px;
            padding: 32px;
            box-shadow: var(--card-shadow);
            border: 1px solid var(--border-color);
            position: relative;
            overflow: hidden;
        }

        .role-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: var(--gradient);
            z-index: 1;
        }

        .role-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 24px;
        }

        .role-title {
            font-size: 32px;
            font-weight: 700;
            color: var(--text-primary);
            font-family: 'Poppins', sans-serif;
        }

        .edit-btn {
            padding: 10px 16px;
            background: var(--gradient);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: var(--transition);
        }

        .edit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(99, 102, 241, 0.3);
        }

        .skills-section, .companies-section {
            margin-bottom: 24px;
        }

        .section-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-title i {
            color: var(--primary);
        }

        .skills-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .skill-tag {
            display: inline-block;
            background: rgba(99, 101, 241, 0.11);
            color: var(--primary-dark);
            padding: 8px 14px;
            border-radius: 8px;
            font-size: 13px;
            font-weight: 500;
            transition: var(--transition);
            border: 1px solid rgba(99, 102, 241, 0.2);
        }

        .skill-tag:hover {
            background: rgba(99, 102, 241, 0.2);
            transform: translateY(-2px);
        }

        .companies-logos {
            display: flex;
            flex-wrap: wrap;
            gap: 16px;
            align-items: center;
        }
    

        .company-logo {
    min-width: 60px;
    height: 60px;
    border-radius: 12px;
    background: var(--bg-tertiary);
    display: flex;
    align-items: center;
    justify-content: center;
    border: 1px solid var(--border-color);
    font-weight: 600;
    color: var(--text-secondary);
    font-size: 12px;
    transition: var(--transition);
    padding: 0 12px;
    white-space: nowrap;
}

        .company-logo:hover {
            transform: translateY(-4px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
        }

        /* Role Info Section */
        .role-info-section {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 32px;
        }

        .info-card {
            background: var(--bg-secondary);
            border-radius: 16px;
            padding: 32px;
            box-shadow: var(--card-shadow);
            border: 1px solid var(--border-color);
        }

        .description-content, .skills-content, .tools-content, .salary-content {
            margin-bottom: 20px;
            color: var(--text-secondary);
            line-height: 1.7;
        }

        .tools-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 12px;
        }

        .tool-tag {
            display: inline-block;
            background: rgba(245, 158, 11, 0.11);
            color: var(--accent);
            padding: 8px 14px;
            border-radius: 8px;
            font-size: 13px;
            font-weight: 500;
            transition: var(--transition);
            border: 1px solid rgba(245, 158, 11, 0.2);
        }

        .tool-tag:hover {
            background: rgba(245, 158, 11, 0.2);
            transform: translateY(-2px);
        }

        .salary-amount {
            font-size: 24px;
            font-weight: 700;
            color: var(--success);
            margin: 12px 0;
        }

        .companies-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 12px;
        }

        .company-tag {
            display: inline-block;
            background: rgba(16, 185, 129, 0.11);
            color: var(--success);
            padding: 8px 14px;
            border-radius: 8px;
            font-size: 13px;
            font-weight: 500;
            transition: var(--transition);
            border: 1px solid rgba(1, 19, 13, 0.171);
        }

        .company-tag:hover {
            background: rgba(16, 185, 129, 0.2);
            transform: translateY(-2px);
        }

        .prepare-btn {
            padding: 16px 32px;
            background: var(--gradient);
            color: white;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            font-size: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: var(--transition);
            margin-top: 16px;
            width: 100%;
        }

        .prepare-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(99, 102, 241, 0.4);
        }

        /* Empty state styling */
        .empty-state {
            color: var(--text-secondary);
            font-style: italic;
            text-align: center;
            padding: 20px;
            background: rgba(0, 0, 0, 0.03);
            border-radius: 8px;
            margin: 10px 0;
        }

        /* Modal styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(5px);
            padding: 20px;
        }

        .modal.show {
            display: flex;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: var(--bg-secondary);
            border-radius: 16px;
            width: 540px;
            max-width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            padding: 32px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            border: 1px solid var(--border-color);
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 28px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border-color);
        }

        .modal-header h2 {
            font-size: 24px;
            color: var(--text-primary);
            font-weight: 600;
            font-family: 'Poppins', sans-serif;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 28px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: var(--transition);
        }

        .close-modal:hover {
            color: var(--accent);
            transform: rotate(90deg);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 500;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .form-control {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid var(--border-color);
            border-radius: 12px;
            background: var(--bg-tertiary);
            color: var(--text-primary);
            transition: var(--transition);
            font-size: 15px;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2);
        }

        .multi-input-container {
            display: flex;
            gap: 12px;
        }

        .multi-input-container input {
            flex: 1;
        }

        .add-item-btn {
            padding: 14px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            color: var(--text-primary);
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .add-item-btn:hover {
            background: var(--primary);
            color: white;
        }

        .items-list {
            margin-top: 14px;
            max-height: 150px;
            overflow-y: auto;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .item-tag {
            display: inline-flex;
            align-items: center;
            background: var(--bg-tertiary);
            padding: 10px 16px;
            border-radius: 8px;
            font-size: 14px;
            color: var(--text-primary);
            gap: 8px;
            border: 1px solid var(--border-color);
        }

        .remove-item {
            color: var(--accent);
            cursor: pointer;
            font-size: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }

        .remove-item:hover {
            transform: scale(1.2);
        }

        .submit-btn {
            padding: 16px 24px;
            background: var(--gradient);
            color: white;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 500;
            width: 100%;
            margin-top: 24px;
            transition: var(--transition);
            font-size: 16px;
            box-shadow: 0 4px 6px rgba(99, 102, 241, 0.3);
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(99, 102, 241, 0.4);
        }

        /* Responsive adjustments */
        @media (max-width: 992px) {
            .container {
                flex-direction: column;
            }
            
            .role-details-section, .role-info-section {
                width: 100%;
            }
        }

        @media (max-width: 576px) {
            .role-title {
                font-size: 24px;
            }
            
            .skills-list, .tools-list, .companies-list {
                gap: 8px;
            }
            
            .skill-tag, .tool-tag, .company-tag {
                padding: 6px 12px;
                font-size: 12px;
            }
            
            .company-logo {
                width: 50px;
                height: 50px;
            }
        }

        /* Action buttons grid */
.action-buttons-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
    margin-top: 24px;
}

.action-btn {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 50px 100px;
    border: none;
    border-radius: 20px;
    cursor: pointer;
    font-weight: 600;
    transition: var(--transition);
    min-height: 80px;
     height: 120px; /* Fixed height */
     /* width: 120px; */
    /* width: 140px; Fixed width */
    text-align: center;
    
    
}

.action-btn i {
    font-size: 20px;
    margin-bottom: 8px;
}

.action-btn span {
    font-size: 13px;
}

.action-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
}

/* Different colors for each button */
.explore-projects {
    background: rgba(16, 185, 129, 0.11);
    color: #10B981;
    border: 1px solid rgba(16, 185, 129, 0.2);
}

.save-role {
    background: rgba(99, 102, 241, 0.11);
    color: #6366F1;
    border: 1px solid rgba(99, 102, 241, 0.2);
}

.share-role {
    background: rgba(245, 158, 11, 0.11);
    color: #F59E0B;
    border: 1px solid rgba(245, 158, 11, 0.2);
}

.compare-roles {
    background: rgba(239, 68, 68, 0.11);
    color: #EF4444;
    border: 1px solid rgba(239, 68, 68, 0.2);
}

/* Update the prepare button style */
.prepare-btn {
    padding: 16px 20px;
    background: var(--gradient);
    color: white;
    border: none;
    border-radius: 12px;
    cursor: pointer;
    font-weight: 600;
    font-size: 16px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    transition: var(--transition);
    margin-top: 16px;
    width: 202.5%;
}

.prepare-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 12px rgba(99, 102, 241, 0.4);
}

/* Toggle buttons for paragraph/points */
.format-toggle {
    display: flex;
    gap: 8px;
    margin-bottom: 12px;
}

.toggle-btn {
    padding: 8px 16px;
    border: 1px solid var(--border-color);
    background: var(--bg-tertiary);
    color: var(--text-secondary);
    border-radius: 6px;
    cursor: pointer;
    font-size: 13px;
    font-weight: 500;
    transition: var(--transition);
}

.toggle-btn.active {
    background: var(--primary);
    color: white;
    border-color: var(--primary);
}

.toggle-btn:hover {
    background: var(--border-color);
    color: var(--text-primary);
}


    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="logo">
            <i class="fas fa-briefcase"></i>
            <span>JobPortal</span>
        </div>
        <nav>
    <a href="jobs.html">Jobs</a>
    <a href="companies.html">Companies</a>
    <a href="career-path.html">Career Path</a>
    <a href="roleinfo.html" class="active">Role Info</a>
    <a href="resources.html">Resources</a>
</nav>
        <div class="header-right">
            <button class="theme-toggle">
                <i class="fas fa-moon"></i>
            </button>
            <div class="user-info">
                <div class="user-avatar">JD</div>
                <span>John Doe</span>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="container">
        <!-- Left Section: Role Details -->
        <section class="role-details-section">
            <div class="role-card">
                <div class="role-header">
                    <h1 class="role-title">Job Role Title</h1>
                    <button class="edit-btn" id="editRoleBtn">
                        <i class="fas fa-edit"></i> Edit Details
                    </button>
                </div>
                
                <div class="skills-section">
                    <h3 class="section-title">
                        <i class="fas fa-tools"></i> Essential Skills
                    </h3>
                    <div class="skills-list" id="essentialSkills">
                        <div class="empty-state">No skills added yet</div>
                    </div>
                </div>
                
                <div class="companies-section">
                    <h3 class="section-title">
                        <i class="fas fa-building"></i> Companies Hiring
                    </h3>
                    <div class="companies-logos" id="companiesLogos">
                        <div class="empty-state">No companies added yet</div>
                    </div>
                </div>
            </div>

               <div class="action-buttons-grid">
            <button class="action-btn explore-projects">
                <i class="fas fa-project-diagram"></i>
                <span>Explore Projects</span>
            </button>
            <button class="action-btn save-role">
                <i class="fas fa-bookmark"></i>
                <span>Save Role</span>
            </button>
            <button class="action-btn share-role">
                <i class="fas fa-share-alt"></i>
                <span>Share</span>
            </button>
            <button class="action-btn compare-roles">
                <i class="fas fa-exchange-alt"></i>
                <span>Compare Roles</span>
            </button>
            <button class="prepare-btn">
        <i class="fas fa-rocket"></i> Start Preparing
    </button>
        </section>

        <!-- Right Section: Role Information -->
        <section class="role-info-section">
            <div class="info-card">
                <div class="role-header">
                    <h2 class="section-title">
                        <i class="fas fa-file-alt"></i> Job Description
                    </h2>
                    <button class="edit-btn" id="editDescriptionBtn">
                        <i class="fas fa-edit"></i> Edit
                    </button>
                </div>
                <div class="description-content" id="jobDescription">
                    <div class="empty-state">No job description added yet</div>
                </div>
            </div>
            
            <div class="info-card">
                <div class="role-header">
                    <h2 class="section-title">
                        <i class="fas fa-code"></i> Skills & Technologies
                    </h2>
                    <button class="edit-btn" id="editSkillsBtn">
                        <i class="fas fa-edit"></i> Edit
                    </button>
                </div>
                <div class="skills-content" id="requiredSkills">
                    <div class="empty-state">No skills details added yet</div>
                </div>
                <div class="tools-list" id="toolsList">
                    <!-- Tools will be added here dynamically -->
                </div>
            </div>
            
            <div class="info-card">
                <div class="role-header">
                    <h2 class="section-title">
                        <i class="fas fa-money-bill-wave"></i> Salary Information
                    </h2>
                    <button class="edit-btn" id="editSalaryBtn">
                        <i class="fas fa-edit"></i> Edit
                    </button>
                </div>
                <div class="salary-content">
                    <div id="salaryInfo">
                        <div class="empty-state">No salary information added yet</div>
                    </div>
                </div>
                
                <div class="companies-section">
                    <h3 class="section-title">
                        <i class="fas fa-building"></i> Hiring Companies
                    </h3>
                    <div class="companies-list" id="hiringCompanies">
                        <div class="empty-state">No companies added yet</div>
                    </div>
                </div>
                
 
        </section>
    </div>

    <!-- Edit Role Modal -->
    <div class="modal" id="roleModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Edit Role Information</h2>
                <button class="close-modal">&times;</button>
            </div>
            <form id="roleForm">
                <div class="form-group">
                    <label for="roleTitle">
                        <i class="fas fa-heading"></i> Role Title
                    </label>
                    <input type="text" id="roleTitle" class="form-control" placeholder="Enter job role title">
                </div>
                
                <div class="form-group">
                    <label for="essentialSkills">
                        <i class="fas fa-tools"></i> Essential Skills
                    </label>
                    <div class="multi-input-container">
                        <input type="text" id="skillInput" class="form-control" placeholder="Add a skill">
                        <button type="button" class="add-item-btn" id="addSkillBtn">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                    <div class="items-list" id="skillsList">
                        <!-- Skills will be added here dynamically -->
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="companies">
                        <i class="fas fa-building"></i> Companies
                    </label>
                    <div class="multi-input-container">
                        <input type="text" id="companyInput" class="form-control" placeholder="Add a company">
                        <button type="button" class="add-item-btn" id="addCompanyBtn">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                    <div class="items-list" id="companiesList">
                        <!-- Companies will be added here dynamically -->
                    </div>
                </div>
                
                <button type="submit" class="submit-btn">Save Changes</button>
            </form>
        </div>
    </div>

    <!-- Edit Description Modal -->
    <!-- Edit Description Modal -->
<div class="modal" id="descriptionModal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Edit Job Description</h2>
            <button class="close-modal">&times;</button>
        </div>
        <form id="descriptionForm">
            <div class="form-group">
                <label for="jobDescription">
                    <i class="fas fa-file-alt"></i> Description
                </label>
                <div class="format-toggle">
                    <button type="button" class="toggle-btn active" data-format="paragraph">Paragraph</button>
                    <button type="button" class="toggle-btn" data-format="points">Bullet Points</button>
                </div>
                <textarea id="jobDescriptionInput" class="form-control" rows="6" placeholder="Enter job description"></textarea>
                <div id="pointsContainer" style="display: none;">
                    <div class="multi-input-container">
                        <input type="text" id="pointInput" class="form-control" placeholder="Add a bullet point">
                        <button type="button" class="add-item-btn" id="addPointBtn">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                    <div class="items-list" id="pointsList">
                        <!-- Points will be added here dynamically -->
                    </div>
                </div>
            </div>
            <button type="submit" class="submit-btn">Save Description</button>
        </form>
    </div>
</div>

    <!-- Edit Skills Modal -->
    <!-- Edit Skills Modal -->
<div class="modal" id="skillsModal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Edit Skills & Technologies</h2>
            <button class="close-modal">&times;</button>
        </div>
        <form id="skillsForm">
            <div class="form-group">
                <label for="skillsDetails">
                    <i class="fas fa-code"></i> Skills Details
                </label>
                <div class="format-toggle">
                    <button type="button" class="toggle-btn active" data-format="paragraph">Paragraph</button>
                    <button type="button" class="toggle-btn" data-format="points">Bullet Points</button>
                </div>
                <textarea id="skillsDetailsInput" class="form-control" rows="4" placeholder="Describe required skills"></textarea>
                <div id="skillsPointsContainer" style="display: none;">
                    <div class="multi-input-container">
                        <input type="text" id="skillPointInput" class="form-control" placeholder="Add a skill point">
                        <button type="button" class="add-item-btn" id="addSkillPointBtn">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                    <div class="items-list" id="skillsPointsList">
                        <!-- Skill points will be added here dynamically -->
                    </div>
                </div>
            </div>
            
            <div class="form-group">
                <label for="tools">
                    <i class="fas fa-wrench"></i> Tools & Technologies
                </label>
                <div class="multi-input-container">
                    <input type="text" id="toolInput" class="form-control" placeholder="Add a tool or technology">
                    <button type="button" class="add-item-btn" id="addToolBtn">
                        <i class="fas fa-plus"></i>
                    </button>
                </div>
                <div class="items-list" id="toolsListModal">
                    <!-- Tools will be added here dynamically -->
                </div>
            </div>
            
            <button type="submit" class="submit-btn">Save Skills</button>
        </form>
    </div>
</div>

    <!-- Edit Salary Modal -->
    <div class="modal" id="salaryModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Edit Salary Information</h2>
                <button class="close-modal">&times;</button>
            </div>
            <form id="salaryForm">
                <div class="form-group">
                    <label for="salaryAmount">
                        <i class="fas fa-money-bill-wave"></i> Average Salary
                    </label>
                    <input type="text" id="salaryAmount" class="form-control" placeholder="Enter average salary (e.g., $80,000 - $120,000)">
                </div>
                
                <div class="form-group">
                    <label for="hiringCompanies">
                        <i class="fas fa-building"></i> Hiring Companies
                    </label>
                    <div class="multi-input-container">
                        <input type="text" id="hiringCompanyInput" class="form-control" placeholder="Add a hiring company">
                        <button type="button" class="add-item-btn" id="addHiringCompanyBtn">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                    <div class="items-list" id="hiringCompaniesList">
                        <!-- Hiring companies will be added here dynamically -->
                    </div>
                </div>
                
                <button type="submit" class="submit-btn">Save Salary Info</button>
            </form>
        </div>
    </div>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>

<script>
    // Firebase configuration
   const firebaseConfig = {
    apiKey: "AIzaSyCXb6mPRJT6MsmzZPLOBM3NW6IYEwe9g1s",
    authDomain: "eceverse-caedc.firebaseapp.com",
    projectId: "eceverse-caedc",
    storageBucket: "eceverse-caedc.firebasestorage.app",
    messagingSenderId: "1084496551701",
    appId: "1:1084496551701:web:06c6554d000b599f51531c",
    measurementId: "G-F84HDMZX59"
  };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    const auth = firebase.auth();

    // Global variables
    let currentUser = null;
    let currentJobId = null;
    let currentJobData = null;

    document.addEventListener('DOMContentLoaded', function() {
        // Get the job ID from localStorage
        currentJobId = localStorage.getItem('selectedJobId');
        const jobRole = localStorage.getItem('selectedJobRole');
        
        // Set the role title if available
        if (jobRole) {
            document.querySelector('.role-title').textContent = jobRole;
        }
        
        // Check authentication state
        auth.onAuthStateChanged((user) => {
            if (user) {
                currentUser = user;
                // User is signed in
                document.querySelector('.user-avatar').textContent = user.email.substring(0, 2).toUpperCase();
                document.querySelector('.user-info span').textContent = user.email;
                
                // Show edit buttons only for admin user
                if (user.email === 'srujansrujan@gmail.com') {
                    document.querySelectorAll('.edit-btn').forEach(btn => {
                        btn.style.display = 'flex';
                    });
                } else {
                    document.querySelectorAll('.edit-btn').forEach(btn => {
                        btn.style.display = 'none';
                    });
                }
                
                // Load job data from Firestore if we have a job ID
                if (currentJobId) {
                    loadJobData(currentJobId);
                } else {
                    // If no job ID, show empty state
                    showEmptyStates();
                }
            } else {
                // User is signed out, redirect to login
                window.location.href = 'login.html';
            }
        });

        // Modal elements
        const roleModal = document.getElementById('roleModal');
        const descriptionModal = document.getElementById('descriptionModal');
        const skillsModal = document.getElementById('skillsModal');
        const salaryModal = document.getElementById('salaryModal');
        
        // Buttons to open modals
        const editRoleBtn = document.getElementById('editRoleBtn');
        const editDescriptionBtn = document.getElementById('editDescriptionBtn');
        const editSkillsBtn = document.getElementById('editSkillsBtn');
        const editSalaryBtn = document.getElementById('editSalaryBtn');
        
        // Close buttons
        const closeButtons = document.querySelectorAll('.close-modal');
        
        // Forms
        const roleForm = document.getElementById('roleForm');
        const descriptionForm = document.getElementById('descriptionForm');
        const skillsForm = document.getElementById('skillsForm');
        const salaryForm = document.getElementById('salaryForm');
        
        // Item management
        const addSkillBtn = document.getElementById('addSkillBtn');
        const addCompanyBtn = document.getElementById('addCompanyBtn');
        const addToolBtn = document.getElementById('addToolBtn');
        const addHiringCompanyBtn = document.getElementById('addHiringCompanyBtn');
        
        // Open modals
        // Open modals
editRoleBtn.addEventListener('click', async () => {
    await loadRoleDataToForm();
    roleModal.classList.add('show');
});

editDescriptionBtn.addEventListener('click', async () => {
    await loadDescriptionToForm();
    descriptionModal.classList.add('show');
});

editSkillsBtn.addEventListener('click', async () => {
    await loadSkillsToForm();
    skillsModal.classList.add('show');
});

editSalaryBtn.addEventListener('click', async () => {
    await loadSalaryToForm();
    salaryModal.classList.add('show');
});
        
        // Close modals
        closeButtons.forEach(button => {
            button.addEventListener('click', () => {
                roleModal.classList.remove('show');
                descriptionModal.classList.remove('show');
                skillsModal.classList.remove('show');
                salaryModal.classList.remove('show');
            });
        });
        
        // Close modal when clicking outside
        window.addEventListener('click', (e) => {
            if (e.target === roleModal) roleModal.classList.remove('show');
            if (e.target === descriptionModal) descriptionModal.classList.remove('show');
            if (e.target === skillsModal) skillsModal.classList.remove('show');
            if (e.target === salaryModal) salaryModal.classList.remove('show');
        });
        
        // Add skill with delete functionality
        addSkillBtn.addEventListener('click', () => {
            const skillInput = document.getElementById('skillInput');
            const skill = skillInput.value.trim();
            
            if (skill) {
                const skillsList = document.getElementById('skillsList');
                const skillTag = document.createElement('div');
                skillTag.className = 'item-tag';
                skillTag.innerHTML = `
                    ${skill}
                    <span class="remove-item" data-action="delete">&times;</span>
                `;
                
                skillTag.querySelector('.remove-item').addEventListener('click', function() {
                    if (this.dataset.action === 'delete') {
                        skillsList.removeChild(skillTag);
                    }
                });
                
                skillsList.appendChild(skillTag);
                skillInput.value = '';
            }
        });
        
        // Add company with delete functionality
        addCompanyBtn.addEventListener('click', () => {
            const companyInput = document.getElementById('companyInput');
            const company = companyInput.value.trim();
            
            if (company) {
                const companiesList = document.getElementById('companiesList');
                const companyTag = document.createElement('div');
                companyTag.className = 'item-tag';
                companyTag.innerHTML = `
                    ${company}
                    <span class="remove-item" data-action="delete">&times;</span>
                `;
                
                companyTag.querySelector('.remove-item').addEventListener('click', function() {
                    if (this.dataset.action === 'delete') {
                        companiesList.removeChild(companyTag);
                    }
                });
                
                companiesList.appendChild(companyTag);
                companyInput.value = '';
            }
        });
        
        // Add tool with delete functionality
        addToolBtn.addEventListener('click', () => {
            const toolInput = document.getElementById('toolInput');
            const tool = toolInput.value.trim();
            
            if (tool) {
                const toolsList = document.getElementById('toolsListModal');
                const toolTag = document.createElement('div');
                toolTag.className = 'item-tag';
                toolTag.innerHTML = `
                    ${tool}
                    <span class="remove-item" data-action="delete">&times;</span>
                `;
                
                toolTag.querySelector('.remove-item').addEventListener('click', function() {
                    if (this.dataset.action === 'delete') {
                        toolsList.removeChild(toolTag);
                    }
                });
                
                toolsList.appendChild(toolTag);
                toolInput.value = '';
            }
        });
        
        // Add hiring company with delete functionality
        addHiringCompanyBtn.addEventListener('click', () => {
            const hiringCompanyInput = document.getElementById('hiringCompanyInput');
            const company = hiringCompanyInput.value.trim();
            
            if (company) {
                const hiringCompaniesList = document.getElementById('hiringCompaniesList');
                const companyTag = document.createElement('div');
                companyTag.className = 'item-tag';
                companyTag.innerHTML = `
                    ${company}
                    <span class="remove-item" data-action="delete">&times;</span>
                `;
                
                companyTag.querySelector('.remove-item').addEventListener('click', function() {
                    if (this.dataset.action === 'delete') {
                        hiringCompaniesList.removeChild(companyTag);
                    }
                });
                
                hiringCompaniesList.appendChild(companyTag);
                hiringCompanyInput.value = '';
            }
        });
        
        // Form submissions
      // Form submissions
roleForm.addEventListener('submit', (e) => {
    e.preventDefault();
    
    // Get form data
    const roleTitle = document.getElementById('roleTitle').value;
    const skillsList = document.getElementById('skillsList');
    const companiesList = document.getElementById('companiesList');
    
    const essentialSkills = Array.from(skillsList.children).map(tag => tag.textContent.replace('×', '').trim());
    const companies = Array.from(companiesList.children).map(tag => tag.textContent.replace('×', '').trim());
    
    // Update UI
    if (roleTitle) {
        document.querySelector('.role-title').textContent = roleTitle;
    }
    
    const essentialSkillsContainer = document.getElementById('essentialSkills');
    if (essentialSkills.length > 0) {
        essentialSkillsContainer.innerHTML = '';
        essentialSkills.forEach(skill => {
            const skillTag = document.createElement('span');
            skillTag.className = 'skill-tag';
            skillTag.textContent = skill;
            essentialSkillsContainer.appendChild(skillTag);
        });
    } else {
        essentialSkillsContainer.innerHTML = '<div class="empty-state">No skills added yet</div>';
    }
    
    const companiesLogosContainer = document.getElementById('companiesLogos');
    if (companies.length > 0) {
        companiesLogosContainer.innerHTML = '';
        companies.forEach(company => {
            const logo = document.createElement('div');
            logo.className = 'company-logo';
            logo.textContent = company;
            companiesLogosContainer.appendChild(logo);
        });
    } else {
        companiesLogosContainer.innerHTML = '<div class="empty-state">No companies added yet</div>';
    }
    
    // Save to Firestore (roleDetails collection)
    saveJobData({
        role: roleTitle,
        essentialSkills: essentialSkills,
        companies: companies
    });
    
    roleModal.classList.remove('show');
});
descriptionForm.addEventListener('submit', (e) => {
    e.preventDefault();
    
    const isParagraphFormat = document.querySelector('#descriptionModal .toggle-btn[data-format="paragraph"]').classList.contains('active');
    let description = '';
    
    if (isParagraphFormat) {
        description = document.getElementById('jobDescriptionInput').value;
    } else {
        const points = Array.from(document.getElementById('pointsList').children)
            .map(tag => `• ${tag.textContent.replace('×', '').trim()}`)
            .join('\n');
        description = points;
    }
    
    // Update UI with proper formatting
    const descriptionContainer = document.getElementById('jobDescription');
    if (description) {
        if (description.includes('•')) {
            // Format as bullet points
            const formattedDescription = description
                .split('\n')
                .filter(line => line.trim())
                .map(line => line.trim().startsWith('•') 
                    ? `<div style="display: flex; align-items: flex-start; margin-bottom: 8px;">
                         <span style="margin-right: 8px;">•</span>
                         <span>${line.replace('•', '').trim()}</span>
                       </div>`
                    : `<p>${line}</p>`
                )
                .join('');
            descriptionContainer.innerHTML = formattedDescription;
        } else {
            // Regular paragraph
            descriptionContainer.innerHTML = `<p>${description.replace(/\n/g, '<br>')}</p>`;
        }
    } else {
        descriptionContainer.innerHTML = '<div class="empty-state">No job description added yet</div>';
    }
    
    // Save to Firestore
    saveJobData({
        description: description
    });
    
    descriptionModal.classList.remove('show');
});

skillsForm.addEventListener('submit', (e) => {
    e.preventDefault();
    
    const isParagraphFormat = document.querySelector('#skillsModal .toggle-btn[data-format="paragraph"]').classList.contains('active');
    let skillsDetails = '';
    
    if (isParagraphFormat) {
        skillsDetails = document.getElementById('skillsDetailsInput').value;
    } else {
        const points = Array.from(document.getElementById('skillsPointsList').children)
            .map(tag => `• ${tag.textContent.replace('×', '').trim()}`)
            .join('\n');
        skillsDetails = points;
    }
    
    // Update UI with proper formatting
    const skillsDetailsContainer = document.getElementById('requiredSkills');
    if (skillsDetails) {
        if (skillsDetails.includes('•')) {
            // Format as bullet points
            const formattedSkills = skillsDetails
                .split('\n')
                .filter(line => line.trim())
                .map(line => line.trim().startsWith('•') 
                    ? `<div style="display: flex; align-items: flex-start; margin-bottom: 8px;">
                         <span style="margin-right: 8px;">•</span>
                         <span>${line.replace('•', '').trim()}</span>
                       </div>`
                    : `<p>${line}</p>`
                )
                .join('');
            skillsDetailsContainer.innerHTML = formattedSkills;
        } else {
            // Regular paragraph
            skillsDetailsContainer.innerHTML = `<p>${skillsDetails.replace(/\n/g, '<br>')}</p>`;
        }
    } else {
        skillsDetailsContainer.innerHTML = '<div class="empty-state">No skills details added yet</div>';
    }
    
    const toolsList = document.getElementById('toolsListModal');
    const tools = Array.from(toolsList.children).map(tag => tag.textContent.replace('×', '').trim());
    
    const toolsContainer = document.getElementById('toolsList');
    if (tools.length > 0) {
        toolsContainer.innerHTML = '';
        tools.forEach(tool => {
            const toolTag = document.createElement('span');
            toolTag.className = 'tool-tag';
            toolTag.textContent = tool;
            toolsContainer.appendChild(toolTag);
        });
    }
    
    // Save to Firestore
    saveJobData({
        skillsDetails: skillsDetails,
        tools: tools
    });
    
    skillsModal.classList.remove('show');
});

salaryForm.addEventListener('submit', (e) => {
    e.preventDefault();
    
    const salary = document.getElementById('salaryAmount').value;
    if (salary) {
        document.getElementById('salaryInfo').innerHTML = `
            <p>Average annual salary for this role:</p>
            <div class="salary-amount">${salary}</div>
        `;
    } else {
        document.getElementById('salaryInfo').innerHTML = '<div class="empty-state">No salary information added yet</div>';
    }
    
    const hiringCompaniesList = document.getElementById('hiringCompaniesList');
    const hiringCompanies = Array.from(hiringCompaniesList.children).map(tag => tag.textContent.replace('×', '').trim());
    
    const hiringCompaniesContainer = document.getElementById('hiringCompanies');
    if (hiringCompanies.length > 0) {
        hiringCompaniesContainer.innerHTML = '';
        hiringCompanies.forEach(company => {
            const companyTag = document.createElement('span');
            companyTag.className = 'company-tag';
            companyTag.textContent = company;
            hiringCompaniesContainer.appendChild(companyTag);
        });
    } else {
        hiringCompaniesContainer.innerHTML = '<div class="empty-state">No companies added yet</div>';
    }
    
    // Save to Firestore (roleDetails collection)
    saveJobData({
        salaryInfo: salary,
        hiringCompanies: hiringCompanies
    });
    
    salaryModal.classList.remove('show');
});
        
        // Theme toggle functionality
        const themeToggle = document.querySelector('.theme-toggle');
        themeToggle.addEventListener('click', () => {
            document.body.classList.toggle('dark-theme');
            const icon = themeToggle.querySelector('i');
            
            if (document.body.classList.contains('dark-theme')) {
                icon.classList.remove('fa-moon');
                icon.classList.add('fa-sun');
            } else {
                icon.classList.remove('fa-sun');
                icon.classList.add('fa-moon');
            }
        });
        
        // Action buttons functionality
        document.querySelector('.explore-projects').addEventListener('click', () => {
            alert('Explore Projects functionality would go here');
        });
        
        document.querySelector('.save-role').addEventListener('click', () => {
            alert('Save Role functionality would go here');
        });
        
        document.querySelector('.share-role').addEventListener('click', () => {
            alert('Share Role functionality would go here');
        });
        
        document.querySelector('.compare-roles').addEventListener('click', () => {
            alert('Compare Roles functionality would go here');
        });
        
        document.querySelector('.prepare-btn').addEventListener('click', () => {
            alert('Start Preparing functionality would go here');
        });
    });

   // Firestore functions
async function loadJobData(jobId) {
    try {
        const doc = await db.collection('jobs').doc(jobId).get();
        if (doc.exists) {
            currentJobData = doc.data();
            
            // Update role title (from the job card)
            if (currentJobData.role) {
                document.querySelector('.role-title').textContent = currentJobData.role;
            }
            
            // Load role details from a separate collection
            const roleDetailsDoc = await db.collection('roleDetails').doc(jobId).get();
            
            if (roleDetailsDoc.exists) {
                const roleDetails = roleDetailsDoc.data();
                
                // Update essential skills (from role details, not job card)
                const essentialSkillsContainer = document.getElementById('essentialSkills');
                if (roleDetails.essentialSkills && roleDetails.essentialSkills.length > 0) {
                    essentialSkillsContainer.innerHTML = '';
                    roleDetails.essentialSkills.forEach(skill => {
                        const skillTag = document.createElement('span');
                        skillTag.className = 'skill-tag';
                        skillTag.textContent = skill;
                        essentialSkillsContainer.appendChild(skillTag);
                    });
                } else {
                    essentialSkillsContainer.innerHTML = '<div class="empty-state">No skills added yet</div>';
                }
                
                // Update companies (from role details, not job card)
                const companiesLogosContainer = document.getElementById('companiesLogos');
                if (roleDetails.companies && roleDetails.companies.length > 0) {
                    companiesLogosContainer.innerHTML = '';
                    roleDetails.companies.forEach(company => {
                        const logo = document.createElement('div');
                        logo.className = 'company-logo';
                        logo.textContent = company;
                        companiesLogosContainer.appendChild(logo);
                    });
                } else {
                    companiesLogosContainer.innerHTML = '<div class="empty-state">No companies added yet</div>';
                }
                
                // Update description
                // Update description
const descriptionContainer = document.getElementById('jobDescription');
if (roleDetails.description) {
    if (roleDetails.description.includes('•')) {
        // Format as bullet points
        const formattedDescription = roleDetails.description
            .split('\n')
            .filter(line => line.trim())
            .map(line => line.trim().startsWith('•') 
                ? `<div style="display: flex; align-items: flex-start; margin-bottom: 8px;">
                     <span style="margin-right: 8px;">•</span>
                     <span>${line.replace('•', '').trim()}</span>
                   </div>`
                : `<p>${line}</p>`
            )
            .join('');
        descriptionContainer.innerHTML = formattedDescription;
    } else {
        // Regular paragraph
        descriptionContainer.innerHTML = `<p>${roleDetails.description.replace(/\n/g, '<br>')}</p>`;
    }
} else {
    descriptionContainer.innerHTML = '<div class="empty-state">No job description added yet</div>';
}

// Update skills details
const skillsDetailsContainer = document.getElementById('requiredSkills');
if (roleDetails.skillsDetails) {
    if (roleDetails.skillsDetails.includes('•')) {
        // Format as bullet points
        const formattedSkills = roleDetails.skillsDetails
            .split('\n')
            .filter(line => line.trim())
            .map(line => line.trim().startsWith('•') 
                ? `<div style="display: flex; align-items: flex-start; margin-bottom: 8px;">
                     <span style="margin-right: 8px;">•</span>
                     <span>${line.replace('•', '').trim()}</span>
                   </div>`
                : `<p>${line}</p>`
            )
            .join('');
        skillsDetailsContainer.innerHTML = formattedSkills;
    } else {
        // Regular paragraph
        skillsDetailsContainer.innerHTML = `<p>${roleDetails.skillsDetails.replace(/\n/g, '<br>')}</p>`;
    }
} else {
    skillsDetailsContainer.innerHTML = '<div class="empty-state">No skills details added yet</div>';
}
                
                // Update tools
                const toolsContainer = document.getElementById('toolsList');
                if (roleDetails.tools && roleDetails.tools.length > 0) {
                    toolsContainer.innerHTML = '';
                    roleDetails.tools.forEach(tool => {
                        const toolTag = document.createElement('span');
                        toolTag.className = 'tool-tag';
                        toolTag.textContent = tool;
                        toolsContainer.appendChild(toolTag);
                    });
                }
                
                // Update salary info
                const salaryContainer = document.getElementById('salaryInfo');
                if (roleDetails.salaryInfo) {
                    salaryContainer.innerHTML = `
                        <p>Average annual salary for this role:</p>
                        <div class="salary-amount">${roleDetails.salaryInfo}</div>
                    `;
                } else {
                    salaryContainer.innerHTML = '<div class="empty-state">No salary information added yet</div>';
                }
                
                // Update hiring companies
                const hiringCompaniesContainer = document.getElementById('hiringCompanies');
                if (roleDetails.hiringCompanies && roleDetails.hiringCompanies.length > 0) {
                    hiringCompaniesContainer.innerHTML = '';
                    roleDetails.hiringCompanies.forEach(company => {
                        const companyTag = document.createElement('span');
                        companyTag.className = 'company-tag';
                        companyTag.textContent = company;
                        hiringCompaniesContainer.appendChild(companyTag);
                    });
                } else {
                    hiringCompaniesContainer.innerHTML = '<div class="empty-state">No companies added yet</div>';
                }
            } else {
                // No role details exist yet, show empty states
                showEmptyStates();
                
                // Create empty role details document
                await db.collection('roleDetails').doc(jobId).set({
                    jobId: jobId,
                    role: currentJobData.role,
                    essentialSkills: [],
                    companies: [],
                    description: "",
                    skillsDetails: "",
                    tools: [],
                    salaryInfo: "",
                    hiringCompanies: []
                });
            }
        } else {
            showEmptyStates();
        }
    } catch (error) {
        console.error("Error loading job data:", error);
        showEmptyStates();
    }
}

    
    function showEmptyStates() {
        document.getElementById('essentialSkills').innerHTML = '<div class="empty-state">No skills added yet</div>';
        document.getElementById('companiesLogos').innerHTML = '<div class="empty-state">No companies added yet</div>';
        document.getElementById('jobDescription').innerHTML = '<div class="empty-state">No job description added yet</div>';
        document.getElementById('requiredSkills').innerHTML = '<div class="empty-state">No skills details added yet</div>';
        document.getElementById('salaryInfo').innerHTML = '<div class="empty-state">No salary information added yet</div>';
        document.getElementById('hiringCompanies').innerHTML = '<div class="empty-state">No companies added yet</div>';
    }
    
   async function loadRoleDataToForm() {
    // Load from roleDetails collection, not the job data
    try {
        const roleDetailsDoc = await db.collection('roleDetails').doc(currentJobId).get();
        if (!roleDetailsDoc.exists) return;
        
        const roleDetails = roleDetailsDoc.data();
        
        // Populate role form with existing data from roleDetails
        document.getElementById('roleTitle').value = roleDetails.role || '';
        
        const skillsList = document.getElementById('skillsList');
        skillsList.innerHTML = '';
        if (roleDetails.essentialSkills) {
            roleDetails.essentialSkills.forEach(skill => {
                const skillTag = document.createElement('div');
                skillTag.className = 'item-tag';
                skillTag.innerHTML = `
                    ${skill}
                    <span class="remove-item" data-action="delete">&times;</span>
                `;
                
                skillTag.querySelector('.remove-item').addEventListener('click', function() {
                    if (this.dataset.action === 'delete') {
                        skillsList.removeChild(skillTag);
                    }
                });
                
                skillsList.appendChild(skillTag);
            });
        }
        
        const companiesList = document.getElementById('companiesList');
        companiesList.innerHTML = '';
        if (roleDetails.companies) {
            roleDetails.companies.forEach(company => {
                const companyTag = document.createElement('div');
                companyTag.className = 'item-tag';
                companyTag.innerHTML = `
                    ${company}
                    <span class="remove-item" data-action="delete">&times;</span>
                `;
                
                companyTag.querySelector('.remove-item').addEventListener('click', function() {
                    if (this.dataset.action === 'delete') {
                        companiesList.removeChild(companyTag);
                    }
                });
                
                companiesList.appendChild(companyTag);
            });
        }
    } catch (error) {
        console.error("Error loading role data to form:", error);
    }
}

async function loadDescriptionToForm() {
    // Load from roleDetails collection
    try {
        const roleDetailsDoc = await db.collection('roleDetails').doc(currentJobId).get();
        if (!roleDetailsDoc.exists) return;
        
        const roleDetails = roleDetailsDoc.data();
        
        // Check if description contains bullet points
        if (roleDetails.description && roleDetails.description.includes('•')) {
            // Switch to points format
            document.querySelector('#descriptionModal .toggle-btn[data-format="points"]').classList.add('active');
            document.querySelector('#descriptionModal .toggle-btn[data-format="paragraph"]').classList.remove('active');
            document.getElementById('jobDescriptionInput').style.display = 'none';
            document.getElementById('pointsContainer').style.display = 'block';
            
            // Parse bullet points and add to list
            const pointsList = document.getElementById('pointsList');
            pointsList.innerHTML = '';
            const points = roleDetails.description.split('\n').filter(line => line.trim().startsWith('•'));
            
            points.forEach(point => {
                const pointText = point.replace('•', '').trim();
                if (pointText) {
                    const pointTag = document.createElement('div');
                    pointTag.className = 'item-tag';
                    pointTag.innerHTML = `
                        ${pointText}
                        <span class="remove-item" data-action="delete">&times;</span>
                    `;
                    
                    pointTag.querySelector('.remove-item').addEventListener('click', function() {
                        if (this.dataset.action === 'delete') {
                            pointsList.removeChild(pointTag);
                        }
                    });
                    
                    pointsList.appendChild(pointTag);
                }
            });
        } else {
            // Use paragraph format
            document.querySelector('#descriptionModal .toggle-btn[data-format="paragraph"]').classList.add('active');
            document.querySelector('#descriptionModal .toggle-btn[data-format="points"]').classList.remove('active');
            document.getElementById('jobDescriptionInput').style.display = 'block';
            document.getElementById('pointsContainer').style.display = 'none';
            document.getElementById('jobDescriptionInput').value = roleDetails.description || '';
        }
    } catch (error) {
        console.error("Error loading description to form:", error);
    }
}

async function loadSkillsToForm() {
    // Load from roleDetails collection
    try {
        const roleDetailsDoc = await db.collection('roleDetails').doc(currentJobId).get();
        if (!roleDetailsDoc.exists) return;
        
        const roleDetails = roleDetailsDoc.data();
        
        // Check if skillsDetails contains bullet points
        if (roleDetails.skillsDetails && roleDetails.skillsDetails.includes('•')) {
            // Switch to points format
            document.querySelector('#skillsModal .toggle-btn[data-format="points"]').classList.add('active');
            document.querySelector('#skillsModal .toggle-btn[data-format="paragraph"]').classList.remove('active');
            document.getElementById('skillsDetailsInput').style.display = 'none';
            document.getElementById('skillsPointsContainer').style.display = 'block';
            
            // Parse bullet points and add to list
            const pointsList = document.getElementById('skillsPointsList');
            pointsList.innerHTML = '';
            const points = roleDetails.skillsDetails.split('\n').filter(line => line.trim().startsWith('•'));
            
            points.forEach(point => {
                const pointText = point.replace('•', '').trim();
                if (pointText) {
                    const pointTag = document.createElement('div');
                    pointTag.className = 'item-tag';
                    pointTag.innerHTML = `
                        ${pointText}
                        <span class="remove-item" data-action="delete">&times;</span>
                    `;
                    
                    pointTag.querySelector('.remove-item').addEventListener('click', function() {
                        if (this.dataset.action === 'delete') {
                            pointsList.removeChild(pointTag);
                        }
                    });
                    
                    pointsList.appendChild(pointTag);
                }
            });
        } else {
            // Use paragraph format
            document.querySelector('#skillsModal .toggle-btn[data-format="paragraph"]').classList.add('active');
            document.querySelector('#skillsModal .toggle-btn[data-format="points"]').classList.remove('active');
            document.getElementById('skillsDetailsInput').style.display = 'block';
            document.getElementById('skillsPointsContainer').style.display = 'none';
            document.getElementById('skillsDetailsInput').value = roleDetails.skillsDetails || '';
        }
        
        const toolsList = document.getElementById('toolsListModal');
        toolsList.innerHTML = '';
        if (roleDetails.tools) {
            roleDetails.tools.forEach(tool => {
                const toolTag = document.createElement('div');
                toolTag.className = 'item-tag';
                toolTag.innerHTML = `
                    ${tool}
                    <span class="remove-item" data-action="delete">&times;</span>
                `;
                
                toolTag.querySelector('.remove-item').addEventListener('click', function() {
                    if (this.dataset.action === 'delete') {
                        toolsList.removeChild(toolTag);
                    }
                });
                
                toolsList.appendChild(toolTag);
            });
        }
    } catch (error) {
        console.error("Error loading skills to form:", error);
    }
}

async function loadSalaryToForm() {
    // Load from roleDetails collection
    try {
        const roleDetailsDoc = await db.collection('roleDetails').doc(currentJobId).get();
        if (!roleDetailsDoc.exists) return;
        
        const roleDetails = roleDetailsDoc.data();
        
        document.getElementById('salaryAmount').value = roleDetails.salaryInfo || '';
        
        const hiringCompaniesList = document.getElementById('hiringCompaniesList');
        hiringCompaniesList.innerHTML = '';
        if (roleDetails.hiringCompanies) {
            roleDetails.hiringCompanies.forEach(company => {
                const companyTag = document.createElement('div');
                companyTag.className = 'item-tag';
                companyTag.innerHTML = `
                    ${company}
                    <span class="remove-item" data-action="delete">&times;</span>
                `;
                
                companyTag.querySelector('.remove-item').addEventListener('click', function() {
                    if (this.dataset.action === 'delete') {
                        hiringCompaniesList.removeChild(companyTag);
                    }
                });
                
                hiringCompaniesList.appendChild(companyTag);
            });
        }
    } catch (error) {
        console.error("Error loading salary to form:", error);
    }
}
    
async function saveJobData(data) {
    if (!currentJobId) return;
    
    try {
        await db.collection('roleDetails').doc(currentJobId).update(data);
        console.log("Role details saved successfully");
        
        // Update local data
        const roleDetailsDoc = await db.collection('roleDetails').doc(currentJobId).get();
        if (roleDetailsDoc.exists) {
            currentJobData = { ...currentJobData, ...roleDetailsDoc.data() };
        }
    } catch (error) {
        console.error("Error saving role details:", error);
        
        // If document doesn't exist yet, create it
        if (error.code === 'not-found') {
            try {
                await db.collection('roleDetails').doc(currentJobId).set({
                    jobId: currentJobId,
                    role: currentJobData.role,
                    ...data
                });
                console.log("Role details document created successfully");
            } catch (createError) {
                console.error("Error creating role details document:", createError);
                alert("Error saving data. Please try again.");
            }
        } else {
            alert("Error saving data. Please try again.");
        }
    }
}

// Toggle functionality for paragraph/points
document.addEventListener('DOMContentLoaded', function() {
    // Description format toggle
    const descParagraphBtn = document.querySelector('#descriptionModal .toggle-btn[data-format="paragraph"]');
    const descPointsBtn = document.querySelector('#descriptionModal .toggle-btn[data-format="points"]');
    const descTextarea = document.getElementById('jobDescriptionInput');
    const descPointsContainer = document.getElementById('pointsContainer');
    const addPointBtn = document.getElementById('addPointBtn');
    
    // Skills format toggle
    const skillsParagraphBtn = document.querySelector('#skillsModal .toggle-btn[data-format="paragraph"]');
    const skillsPointsBtn = document.querySelector('#skillsModal .toggle-btn[data-format="points"]');
    const skillsTextarea = document.getElementById('skillsDetailsInput');
    const skillsPointsContainer = document.getElementById('skillsPointsContainer');
    const addSkillPointBtn = document.getElementById('addSkillPointBtn');
    
    // Description toggle functionality
    descParagraphBtn.addEventListener('click', () => {
        descParagraphBtn.classList.add('active');
        descPointsBtn.classList.remove('active');
        descTextarea.style.display = 'block';
        descPointsContainer.style.display = 'none';
    });
    
    descPointsBtn.addEventListener('click', () => {
        descPointsBtn.classList.add('active');
        descParagraphBtn.classList.remove('active');
        descTextarea.style.display = 'none';
        descPointsContainer.style.display = 'block';
    });
    
    // Skills toggle functionality
    skillsParagraphBtn.addEventListener('click', () => {
        skillsParagraphBtn.classList.add('active');
        skillsPointsBtn.classList.remove('active');
        skillsTextarea.style.display = 'block';
        skillsPointsContainer.style.display = 'none';
    });
    
    skillsPointsBtn.addEventListener('click', () => {
        skillsPointsBtn.classList.add('active');
        skillsParagraphBtn.classList.remove('active');
        skillsTextarea.style.display = 'none';
        skillsPointsContainer.style.display = 'block';
    });
    
    // Add point to description
    addPointBtn.addEventListener('click', () => {
        const pointInput = document.getElementById('pointInput');
        const point = pointInput.value.trim();
        
        if (point) {
            const pointsList = document.getElementById('pointsList');
            const pointTag = document.createElement('div');
            pointTag.className = 'item-tag';
            pointTag.innerHTML = `
                ${point}
                <span class="remove-item" data-action="delete">&times;</span>
            `;
            
            pointTag.querySelector('.remove-item').addEventListener('click', function() {
                if (this.dataset.action === 'delete') {
                    pointsList.removeChild(pointTag);
                }
            });
            
            pointsList.appendChild(pointTag);
            pointInput.value = '';
        }
    });
    
    // Add point to skills
    addSkillPointBtn.addEventListener('click', () => {
        const skillPointInput = document.getElementById('skillPointInput');
        const point = skillPointInput.value.trim();
        
        if (point) {
            const skillsPointsList = document.getElementById('skillsPointsList');
            const pointTag = document.createElement('div');
            pointTag.className = 'item-tag';
            pointTag.innerHTML = `
                ${point}
                <span class="remove-item" data-action="delete">&times;</span>
            `;
            
            pointTag.querySelector('.remove-item').addEventListener('click', function() {
                if (this.dataset.action === 'delete') {
                    skillsPointsList.removeChild(pointTag);
                }
            });
            
            skillsPointsList.appendChild(pointTag);
            skillPointInput.value = '';
        }
    });
    
    // Update form submission to handle points format
    const originalDescriptionSubmit = descriptionForm.onsubmit;
    descriptionForm.onsubmit = function(e) {
        e.preventDefault();
        
        const isParagraphFormat = descParagraphBtn.classList.contains('active');
        let description = '';
        
        if (isParagraphFormat) {
            description = descTextarea.value;
        } else {
            const points = Array.from(document.getElementById('pointsList').children)
                .map(tag => `• ${tag.textContent.replace('×', '').trim()}`)
                .join('\n');
            description = points;
        }
        
        if (description) {
            document.getElementById('jobDescription').innerHTML = `<p>${description.replace(/\n/g, '<br>')}</p>`;
        } else {
            document.getElementById('jobDescription').innerHTML = '<div class="empty-state">No job description added yet</div>';
        }
        
        // Save to Firestore
        saveJobData({
            description: description
        });
        
        descriptionModal.classList.remove('show');
    };
    
    const originalSkillsSubmit = skillsForm.onsubmit;
    skillsForm.onsubmit = function(e) {
        e.preventDefault();
        
        const isParagraphFormat = skillsParagraphBtn.classList.contains('active');
        let skillsDetails = '';
        
        if (isParagraphFormat) {
            skillsDetails = skillsTextarea.value;
        } else {
            const points = Array.from(document.getElementById('skillsPointsList').children)
                .map(tag => `• ${tag.textContent.replace('×', '').trim()}`)
                .join('\n');
            skillsDetails = points;
        }
        
        if (skillsDetails) {
            document.getElementById('requiredSkills').innerHTML = `<p>${skillsDetails.replace(/\n/g, '<br>')}</p>`;
        } else {
            document.getElementById('requiredSkills').innerHTML = '<div class="empty-state">No skills details added yet</div>';
        }
        
        const toolsList = document.getElementById('toolsListModal');
        const tools = Array.from(toolsList.children).map(tag => tag.textContent.replace('×', '').trim());
        
        const toolsContainer = document.getElementById('toolsList');
        if (tools.length > 0) {
            toolsContainer.innerHTML = '';
            tools.forEach(tool => {
                const toolTag = document.createElement('span');
                toolTag.className = 'tool-tag';
                toolTag.textContent = tool;
                toolsContainer.appendChild(toolTag);
            });
        }
        
        // Save to Firestore
        saveJobData({
            skillsDetails: skillsDetails,
            tools: tools
        });
        
        skillsModal.classList.remove('show');
    };
});
</script>
</body>
</html>