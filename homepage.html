<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ECEverse - Dashboard</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --primary: #6C63FF;
      --secondary: #4D44DB;
      --accent: #FF6584;
      --light: #F8F9FF;
      --dark: #2E2E48;
      --gray: #8C8CA1;
      --card-bg: #FFFFFF;
      --section-bg: #F9FAFF;
      --success: #4ADE80;
      --warning: #FACC15;
    }
    * { margin:0; padding:0; box-sizing:border-box; font-family: 'Inter', sans-serif;}
    body { background: var(--section-bg); color: var(--dark); overflow-x: hidden; }
    header { position: fixed; top:0; left:0; right:0; display:flex; justify-content:space-between; align-items:center; padding:1.2rem 5%; background-color: rgba(255,255,255,0.98); box-shadow:0 2px 30px rgba(108,99,255,0.08); z-index:1000;}
    .logo { font-size:1.4rem; font-weight:700; color: var(--primary); display:flex; align-items:center;}
    .logo i { margin-right:0.5rem;}
    nav a { margin-left:1.2rem; text-decoration:none; color:var(--dark); font-weight:500; }
    nav a:hover { color: var(--primary); }
    .container { padding: 120px 5% 50px; max-width:1400px; margin:0 auto; }
    .welcome-section { 
      display: flex; 
      justify-content: space-between; 
      align-items: center; 
      margin-bottom: 2rem; 
      flex-wrap: wrap;
    }
    .welcome { font-size:2rem; font-weight:600; }
    
    .quick-links { 
      display: grid; 
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); 
      gap: 1.5rem; 
      margin-bottom: 2.5rem; 
    }
    .card { background: var(--card-bg); padding:2rem; border-radius:16px; box-shadow:0 5px 25px rgba(0,0,0,0.05); transition:0.3s; position: relative; overflow: hidden; }
    .card:hover { transform: translateY(-6px); box-shadow:0 12px 30px rgba(108,99,255,0.15); }
    .card h3 { margin-bottom:0.8rem; font-size:1.2rem; font-weight:600; }
    .card p { color: var(--gray); font-size:0.95rem; margin-bottom:1rem; }
    .card a { color: var(--primary); font-weight:600; text-decoration:none; display: flex; align-items: center; }
    .card a:hover { color: var(--secondary); }
    .card a i { margin-left: 0.5rem; transition: 0.3s; }
    .card a:hover i { transform: translateX(4px); }
    
    .quote { text-align:center; font-style:italic; color: var(--gray); margin-top:3rem; padding: 1.5rem; background: var(--light); border-radius: 16px; }
    
    .floating-elements { position:absolute; width:100%; height:100%; top:0; left:0; pointer-events:none; z-index:0; }
    .floating-element { position:absolute; border-radius:50%; background: rgba(108,99,255,0.08); animation: float 15s infinite linear; }
    
    @keyframes float { 
      0% { transform: translateY(0) rotate(0deg); } 
      50% { transform: translateY(-30px) rotate(180deg); } 
      100% { transform: translateY(0) rotate(360deg); } 
    }
    
    /* Responsive adjustments */
    @media (max-width: 1024px) {
      .dashboard-grid { grid-template-columns: 1fr; }
    }
    
    @media (max-width: 768px) {
      .welcome-section { flex-direction: column; align-items: flex-start; }
      .quick-links { grid-template-columns: 1fr; }
    }

    @media (max-width: 480px) {
      .container {
        padding: 100px 4% 30px;
      }
      
      header {
        padding: 1rem 4%;
      }
      
      nav a {
        margin-left: 0.8rem;
        font-size: 0.9rem;
      }
      
      .welcome {
        font-size: 1.5rem;
      }
      
      .card {
        padding: 1.5rem;
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="logo"><i class="fas fa-bolt"></i> ECEverse</div>
    <nav>
      <a href="problems.html">Problems</a>
      <a href="solidcommunity.html">Community</a>
      <a href="skilltree1.html">Jobs Roles</a>
      <a href="#" id="logoutBtn">Logout</a>
    </nav>
  </header>

  <div class="container">
    <div class="welcome-section">
      <div class="welcome">üëã Hi <span id="usernameDisplay"></span>, welcome back!</div>
    </div>

    <!-- Quick cards -->
    <div class="quick-links">
      <div class="card">
        <h3>‚ö° Solve Problems</h3>
        <p>Practice electronics and coding problems tailored for you.</p>
        <a href="problems.html">Start Solving <i class="fas fa-arrow-right"></i></a>
      </div>
      <div class="card">
        <h3>üåê Community</h3>
        <p>Connect with peers and industry professionals to discuss queries.</p>
        <a href="solidcommunity.html">Join Community <i class="fas fa-arrow-right"></i></a>
      </div>
      <div class="card">
        <h3>üíº Job Roles</h3>
        <p>Explore internships and job opportunities in your domain.</p>
        <a href="jobs.html">View Jobs <i class="fas fa-arrow-right"></i></a>
      </div>
    </div>

    <!-- Quote -->
    <div class="quote">"Electronics is the art of controlling electrons in ways that surprise even the electrons." ‚ö° - Dr. Eleanor Maxwell</div>
  </div>

  <!-- Floating background circles -->
  <div class="floating-elements">
    <div class="floating-element" style="width:60px;height:60px;top:20%;left:10%;animation-duration:12s;"></div>
    <div class="floating-element" style="width:80px;height:80px;top:65%;left:80%;animation-duration:18s;"></div>
    <div class="floating-element" style="width:50px;height:50px;top:80%;left:30%;animation-duration:14s;"></div>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-app.js";
    import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-auth.js";
    import { getDatabase, ref, get, child } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-database.js";

   const firebaseConfig = {
     apiKey: "AIzaSyD4T6rAV2npex-ZOJuu5IKQ1bDUkD7o9Oc",
    authDomain: "eceverse-adeac.firebaseapp.com",
    databaseURL: "https://eceverse-adeac-default-rtdb.firebaseio.com",
    projectId: "eceverse-adeac",
    storageBucket: "eceverse-adeac.firebasestorage.app",
    messagingSenderId: "55835462054",
    appId: "1:55835462054:web:9ca23a5817ed40f2842767",
    measurementId: "G-KTV3P359DX"
  };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getDatabase(app);

    const usernameDisplay = document.getElementById('usernameDisplay');
    const logoutBtn = document.getElementById('logoutBtn');

    // Check if user is logged in
    onAuthStateChanged(auth, async (user) => {
      if (user) {
        try {
          // Get username from Realtime Database using UID
          const dbRef = ref(db);
          const snapshot = await get(child(dbRef, `users/${user.uid}`));
          
          if(snapshot.exists()){
            const userData = snapshot.val();
            // Get username directly from user data
            usernameDisplay.textContent = userData.username || user.email.split('@')[0];
          } else {
            // Fallback to email username if no user data found
            usernameDisplay.textContent = user.email.split('@')[0];
          }
        } catch (err) {
          console.error(err);
          usernameDisplay.textContent = user.email.split('@')[0];
        }
      } else {
        // Not logged in, redirect to login page
        window.location.href = "login.html";
      }
    });

    // Logout button
    logoutBtn.addEventListener('click', () => {
      signOut(auth).then(() => {
        window.location.href = "login.html";
      }).catch((error) => {
        console.error('Logout error:', error);
      });
    });
  </script>
</body>
</html>